import e from"../../_node/@babel/runtime/helpers/esm/asyncToGenerator.js";import r from"../../_node/@babel/runtime/helpers/esm/defineProperty.js";import t from"../../_node/@babel/runtime/regenerator/index.js";function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function a(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))}))}return e}var i={getRow:function(e,r){var t=this,n=[];if(this.isArray(e))n=e;else if(this.isObject(e)){var a;n=null!=e&&e.form?null==e||null===(a=e.form)||void 0===a?void 0:a.data:e.data}var i=this.hasArray(n)?n.filter((function(e){return t.hasObject(e)&&e.name===r})):[];return this.hasArray(i)?i[0]:(console.log(r+"不存在"),{})},getRows:function(e,r,t,n){var a=this,i=[];if(this.isArray(e))i=e;else if(this.isObject(e)){var o;i=null!=e&&e.form?null==e||null===(o=e.form)||void 0===o?void 0:o.data:e.data}this.hasArray(r)?i.forEach((function(e,o){a.hasObject(e)&&r.includes(e.name)&&(i[o][t]=n)})):this.getRow(e,r)[t]=n},hideRows:function(e,r,t){this.getRows(e,r,"hide",t)},disabledRows:function(e,r,t){this.getRows(e,r,"disabled",t)},getCurrentRow:function(e,r){var t=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.$config.idStr,a=e.filter((function(e){return t.hasObject(e)&&e[n]===r}));return a.length>0?a[0]:{}},getFormFormat:function(e){var t,n=e.label,i=e.name,o=e.value,u=e.idStr,s=e.nameStr,l=e.data,c=e.uploadData,f=e.form,d=e.submit,h=e.sname,p=e.formType,m={},b={},g=null,v=null,w={},y=null;if(this.hasArray(l)&&["select","radio"].includes(p)&&(y=(t=this.getCurrentRow(l,o,u,s))[s],h&&d&&(d[h]=y)),f){if(["select","radio"].includes(p)&&(g=t[s]),["tags","checkbox-group"].includes(p)&&this.hasArray(l)&&(g=l.map((function(e){return e[s]}))),["tree-select"].includes(p)&&this.hasArray(l)){var O=function(e,t,n){var a=window.$fn,i=[];return function e(o){o.forEach((function(o){var u;a.hasArray(o.children)?e(o.children):i.push((r(u={},n,o[n]),r(u,t,o[t]),u))}))}(e),i}(l,u,s);g=[],this.hasArray(o)?o.forEach((function(e){O.forEach((function(r){e===r[u]&&g.push(r[s])}))})):O.forEach((function(e){o===e[u]&&(g=e[s])}))}return["text"].includes(p)&&(g=o),["upload"].includes(p)&&(g=c.fileName,v=c.url,w={data:c}),n&&(n=n.includes("请")?n.replace("请",""):n),m=v?{label:n,text:g,url:v}:{label:n,text:g},b={label:g,value:o},this.isObject(f)&&(f[i]=m),a({value:o,row:t,name:i,labelValue:b,backValue:m,model:i?r({},i,o):{}},w)}return{value:o,row:t,name:i,rowName:y,uploadData:c,model:i?r({},i,o):{}}},ajax:function(r){var n=this;return e(t.mark((function e(){var i,o,u,s,l,c,f,d,h,p,m,b,g,v,w,y,O;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.setAjax,o=r.setLoading,u=r.data,s=r.api,l=r.cache,r.my,c=r.param,f=r.setName,d=r.paging,h=window,p=h.$http,b="pull",n.isString(c)||n.isNumber(c)?m=c:d&&(c=a({page:1,size:1e4},c),b="paging"),!s){e.next=24;break}if(!l){e.next=13;break}return e.next=8,n.indexDB(s);case 8:if(w=e.sent,!n.hasArray(w)){e.next=13;break}return f&&(w=w.map((function(e,r){return f(e,r)}))),i(w),e.abrupt("return",w);case 13:return y=o?{onLoading:function(e){return o(e)}}:null,e.next=16,p[b](null,s,a({id:m,param:c},y));case 16:return O=e.sent,O=null!==(g="paging"===b?null===(v=O)||void 0===v?void 0:v.data:O)&&void 0!==g?g:[],l&&n.indexDB(s,O),f&&(O=O.map((function(e,r){return f(e,r)}))),i&&i(O),e.abrupt("return",O);case 24:return e.abrupt("return",u);case 25:case"end":return e.stop()}}),e)})))()}};export{i as default};
