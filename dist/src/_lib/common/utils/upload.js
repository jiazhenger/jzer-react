import e from"../../_node/@babel/runtime/helpers/esm/defineProperty.js";import r from"../../_node/@babel/runtime/helpers/esm/asyncToGenerator.js";import t from"../../_node/@babel/runtime/regenerator/index.js";function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function a(r){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){e(r,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(a,e))}))}return r}var o=window,u=o.$fn,i=o.$http,p=["jpg","png","jpeg","gif"],c=function(e,r,t){for(var n=new FormData,a=0;a<r.length;a++)n.append(e,r[a]);if(null!==n.get(e)){if(t)for(var o in t)t.hasOwnProperty(o)&&n.append(o,t[o]);return n}},s=function(e){var r=e.api,t=e.change,n=e.param,a=e.way,o=e.mul,u=document.querySelector("#jz-upload");u||(u=document.createElement("input"),o&&u.setAttribute("multiple","multiple"),u.setAttribute("type","file")),u.click(),u.onchange=function(e){var o=c("file",e.target.files,n);i.upload(null,r,{param:o,way:a}).then((function(e){null==t||t(e)})),u.value=""}},f=function(){var e=r(t.mark((function e(r,n){var o,i,s,f,l,b,m;return t.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a({name:"file",param:{}},n),u.hasObject(r)&&r.target){e.next=3;break}return e.abrupt("return",u.toast("未选择要上传的图片"));case 3:i=r.target.files,s=!0,f=0;case 6:if(!(f<i.length)){e.next=20;break}if(l=i[f],b=l.name.substring(l.name.lastIndexOf(".")+1).toLowerCase(),-1!==p.indexOf(b)){e.next=13;break}return u.toast(l.name+"的格式必须为png、jpg、jpeg！"),s=!1,e.abrupt("break",20);case 13:if(!(l.size>2097152)){e.next=17;break}return u.toast(l.name+"文件尺寸超过最大限制2M"),s=!1,e.abrupt("break",20);case 17:f++,e.next=6;break;case 20:if(s){e.next=22;break}return e.abrupt("return");case 22:return m=c(o.name,i,o.param),e.abrupt("return",m);case 24:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}();export{c as FormDataUploader,f as getUpload,s as upload};
