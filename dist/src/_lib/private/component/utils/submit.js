import e from"../../../_node/@babel/runtime/helpers/esm/defineProperty.js";function o(e,o){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);o&&(r=r.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),l.push.apply(l,r)}return l}function l(l){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(o){e(l,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(t,e))}))}return l}var r=window,t=r.$fn,n=r.$http,i=r.$config,a=function(o){var r,a,d=o.ajax,s=o.param,u=o.submitConfig,c=void 0===u?{}:u,f=o.form,m=o.formRef,v=o.onSubmit,p=o.tableRef,b=o.modalTableRef,g=o.modalRef,R=o.title,y=c.api,O=c.modApi,w=c.clearApi,h=c.way,j=void 0===h?"post":h,P=c.modWay,S=void 0===P?null!==(r=null==i?void 0:i.modWay)&&void 0!==r?r:"put":P,T=c.loading,x=void 0!==T&&T,k=c.loadingText,D=c.back,E=c.backRefresh,A=c.must,C=c.empty,$=c.refApi,F=c.id,K=c.idStr,N=void 0===K?i.postIdName:K,V=c.mode,W=c.add,B=c.mod,I=c.successText,_=c.close,q=c.r,z=c.c,G=c.rs,H=c.rc,J=c.setNewParam,L=c.setParam,M=c.onValid,Q=c.onComplete,U=c.onSuccess,X=c.onFail,Y=c.onError;if(s=l(l({},t.getResult(c.param)),t.getResult(s)),s=L?l(l({},s),L(s)):s,J&&(s=J(s)),!M||!M(s))if(v=null!==(a=v)&&void 0!==a?a:null==c?void 0:c.onSubmit,p=t.getResult(p),y&&!v)"mod"===V?(j=S,C=void 0===C||C,y=null!=O?O:y,A||(s=l(e({},N,F),s)),t.hasObject(d.ids)&&!A&&(s=l(l({},d.ids),s))):"add"===V&&(C=!1),H=t.getResult(H),q=t.getResult(q),z=t.getResult(z),w&&(w=t.isString(w)?w:$),R=R||c.title,n[j](d,y,{param:s,id:A?F:null,loadingText:k,loading:x,empty:C,onEnd:function(){return null==Q?void 0:Q({formRef:m,colse:null==g?void 0:g.close})},onFail:function(e){return null==X?void 0:X({formRef:m,colse:null==g?void 0:g.close,data:e})},onError:function(){return null==Y?void 0:Y({formRef:m,colse:null==g?void 0:g.close})}}).then((function(e){var o;p&&(q&&p.refresh(G),z&&p.clearKeys(),!H||q||z||p.refreshClear(G)),b&&b.clearKeys();var l=(null!==(o=R)&&void 0!==o?o:"操作")+"成功";I&&(l=I),t.msg.success(l);var r={data:e,param:s,formRef:m,tableRef:p,modalTableRef:b,colse:null==g?void 0:g.close};null==U||U(r),w&&t.indexDBRemove(w),D&&window.history.back(),E&&(window.history.back(),!0!==E&&1!==E||(E="refresh"),setTimeout((function(){var e,o;return null===(e=(o=window)[E])||void 0===e?void 0:e.call(o)}),100)),!1!==(_=t.getResult(_,{mod:B,add:W}))&&g&&(null==g||g.close())}));else{var Z,ee,oe=m?{formParam:null==m||null===(Z=m.getValue)||void 0===Z?void 0:Z.call(m),formRef:m}:null;!1!==(null===(ee=v)||void 0===ee?void 0:ee(l(l({param:s,modalRef:g},oe),{},{tableRef:p,modalTableRef:b,close:null==g?void 0:g.close,form:f})))&&(null==g||g.close())}};export{a as default};
