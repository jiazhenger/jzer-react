import e from"../../../../../node_modules/@babel/runtime/helpers/esm/extends.js";import o from"../../../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js";import t from"../../../../../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js";import n from"../../../../../node_modules/@babel/runtime/helpers/esm/slicedToArray.js";import l,{useState as a,useRef as i,useEffect as r,useImperativeHandle as d}from"react";import s from"../utils/submit.js";import u from"./item/item-list.js";function c(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}))}return e}var f=window,p=f.$lazy,b=f.$,v=f.$fn,g=f.$http,j=f.$config,h=p.hook((function(){return import("../../../global/plugin/antd/form/layout/form.js")})),y=p.load((function(){return import("../../../global/plugin/antd/form/layout/item.js")})),O=p.load((function(){return import("../../../global/template/scroll.js")})),R=p.load((function(){return import("../temp/Controls.js")})),k=p.load((function(){return import("../../../global/plugin/antd/loading.js")})),x=function(c,f){var p,x,w,E,z,C,P,S,D,N,A=c.className,$=c.style,T=c.data,_=c.onInit,M=c.onChange,V=c.onChanged,B=c.onSubmit,F=c.loading,I=c.disabled,L=c.readOnly,U=c.size,W=void 0===U?"submit":U,q=c.dir,G=void 0===q?"x":q,H=c.x,J=c.colon,K=void 0===J||J,Q=c.loadingSize,X=c.width,Y=c.controls,Z=void 0===Y?{}:Y,ee=c.form,oe=c.submit,te=c.hideErrorText,ne=c.nowrap,le=c.labelWidth,ae=void 0===le?"s4":le,ie=c.mb,re=void 0===ie?20:ie,de=c.loadingMode,se=void 0===de?0:de,ue=c.paddingClass,ce=void 0===ue?"p10":ue,me=c.padding,fe=void 0===me?8:me,pe=c.scroll,be=void 0===pe||pe,ve=c.scrollConfig,ge=c.prefix,je=c.suffix,he=c.isSubmitForm,ye=void 0===he||he,Oe=c.hasMaskLoading,Re=c.api,ke=c.param,xe=c.cache,we=void 0===xe?j.cache:xe,Ee=c.mod,ze=c.add,Ce=c.listData,Pe=c.mode,Se=c.way,De=a(Ce),Ne=n(De,2),Ae=Ne[0],$e=Ne[1],Te=i();v.isObject(Z)&&(Z.align=null!==(P=null===(S=Z)||void 0===S?void 0:S.align)&&void 0!==P?P:"center",Z.size=null!==(D=null===(N=Z)||void 0===N?void 0:N.size)&&void 0!==D?D:"middle");var _e=a({loading:F}),Me=n(_e,2),Ve=Me[0],Be=Me[1],Fe=a(v.getResult(T,{mod:Ee,add:ze})),Ie=n(Fe,2),Le=Ie[0],Ue=Ie[1],We=a([]),qe=n(We,2),Ge=qe[0],He=qe[1];r((function(){void 0===F||Re||Be((function(){return{loading:F}}))}),[F,Re]),r((function(){return Ue(v.getResult(T,{mod:Ee,add:ze}))}),[T,Ee,ze]),r((function(){return $e(Ce)}),[Ce]);var Je=m(m({},b.ref(Te)),{},{update:function(e){v.hasArray(e)?Ue(t(e)):Ue((function(e){return t(e)}))}});d(f,(function(){return{ref:function(){return Je},SubmitUtils:s}}));var Ke=be?0:10,Qe=null;H&&(be=!1,ae=null,v.isObject(Z)&&(Z.size=W),Ke=0,Qe={padding:fe});var Xe={size:W,colon:K,width:X,mb:re,readOnly:L,onChanged:V,x:H,cache:we,form:ee,submit:oe,nowrap:ne,ctrlMode:Pe,data:Le,listData:Ae,paddingClass:H?"":b.css(!be,ce),className:b.css(H,"ex"),disabled:I||0===se&&Ve.loading,formRef:function(){return b.ref(Te)},expose:Je},Ye=l.createElement(u,Xe);return l.createElement(h,{ref:Te,className:"rel jzer-form jzer-form-".concat(W," ").concat(b.css(be,"fv ex")," ").concat(b.css(H,"fx")," ").concat(ae," ").concat(b.css(A)),style:m(m({},Qe),$),dir:G,onChange:M,onNameChange:function(e){},data:Le,param:ke,hideErrorText:te,onRef:function(e){ke=v.getResult(ke),e.setDefaultValue(Le,ke),ye&&function(e){var t=c.onBackData,n=c.backData,l=c.infoApi,a=c.api,i=c.id,r=c.idStr,d=void 0===r?j.postIdName:r,s=c.backParam,u=c.abs,f=c.onAdd,p=c.onEnd,b=c.mode;if(s=v.getResult(s),l=l||a,"add"===b)return null==f?void 0:f();if(i||"mod"===b||"info"===b)if(i=v.getResult(i),u||(s=i?m(o({},d,i),s):s),i=s?null:i,!1!==c.infoApi||0!==c.infoApi)g.pull(Be,l,{id:i,param:s}).then((function(o){var l,a={data:o,formRef:e};"list"===b?$e(o):t?null==t||t(a):(n=v.getResult(n,a),null==e||null===(l=e.setValue)||void 0===l||l.call(e,m(m({},o),n))),null==p||p(a)}));else{var h,y={config:c,formRef:e};n?null==e||null===(h=e.setValue)||void 0===h||h.call(e,v.getResult(n,y)):null==t||t(y),null==p||p(y)}}(e),null==_||_({formRef:e,param:ke,data:T}),He(function(e){if(Z=v.getResult(Z,{formRef:e}),v.isObject(Z)&&!Z.data){var o=Z,n=o.ok,l=o.back,a=o.reset,i=o.before,r=void 0===i?[]:i,d=o.after,s=void 0===d?[]:d,u=o.antd;return[].concat(t(r),[v.isObject(l)?m({label:"返回",type:"default",mode:"back",click:function(){var o,t;!1!==(null===(o=Z)||void 0===o||null===(t=o.onBack)||void 0===t?void 0:t.call(o,e))&&v.back()}},l):null,v.isObject(a)?m({label:"重置",ghost:!0,mode:"reset",click:function(){var o,t;e.reset(),null===(o=Z)||void 0===o||null===(t=o.onReset)||void 0===t||t.call(o,e)}},a):null,!1!==n&&0!==n?m({label:"提交",antd:m({htmlType:"submit"},u)},n):null],t(s))}return Z.data}(e))},onSubmit:function(e){var o,t=b.ref(Te),n=null===(o=oe)||void 0===o?void 0:o.back;n&&(oe=m(m({},n),oe),v.hasObject(n)&&delete oe.back),e=m(m({},oe),e),ye?s({onSubmit:B,param:e,submitConfig:c,ajax:Be,formRef:t,form:ee,way:Se}):null==B||B({param:e,formRef:t,form:ee})}},be?l.createElement("div",{className:"ex rel"},l.createElement(O,e({className:b.css(ce)},ve),ge,Ye,je)):l.createElement(l.Fragment,null,ge,Ye,je),!1!==Z&&0!==Z&&l.createElement(y,e({className:"".concat(b.css(be,"tbor1")),label:" ",colon:!1,mt:Ke},null===(p=Z)||void 0===p?void 0:p.item),l.createElement(R,e({loading:0===se&&Ve.loading,className:b.css(!H&&be,null!==(x=null===(w=Z)||void 0===w?void 0:w.paddingClass)&&void 0!==x?x:"p10"),align:null===(E=Z)||void 0===E?void 0:E.align,size:null===(z=Z)||void 0===z?void 0:z.size,data:Ge},null===(C=Z)||void 0===C?void 0:C.config))),(1===se||Oe)&&l.createElement(k,{loading:Ve.loading,loadingSize:Q}))};export{x as default};
