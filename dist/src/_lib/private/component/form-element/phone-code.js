import e from"../../../_node/@babel/runtime/helpers/esm/extends.js";import t from"../../../_node/@babel/runtime/helpers/esm/defineProperty.js";import n from"../../../_node/@babel/runtime/helpers/esm/slicedToArray.js";import r from"react";function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var a=window,i=a.$lazy,s=a.$fn,u=a.$http,c=i.load((function(){return import("../../../global/plugin/antd/form/input.js")})),m=i.load((function(){return import("../../../global/plugin/antd/button.js")})),f=function(o){o.className,o.style;var a=o.name,i=o.label,f=o.size,p=void 0===f?"small":f,d=o.p,b=o.formRef,g=o.phoneStr,v=void 0===g?"phone":g,y=o.duration,O=void 0===y?60:y,j=o.value,h=o.disabled,w=o.onChange,E=o.onChanged,P=o.input,S=void 0===P?{}:P,z=o.btn,C=void 0===z?{}:z,D=o.api,N=o.param,$=r.useState(),k=n($,2),x=k[0],_=k[1],A=r.useState(O),I=n(A,2),L=I[0],V=I[1],F=r.useState("发送验证码"),R=n(F,2),T=R[0],q=R[1];S=l({disabled:h,p:d,label:i,name:a,size:p,out:1,value:j},S);return r.createElement("div",{className:"fx"},r.createElement(c,e({onChange:function(e){var n=a?{model:t({},a,e)}:null;null==w||w(e),null==E||E(l({value:e,label:i},n))}},S)),r.createElement(m,e({className:"ml10",onClick:function(){if(!x){var e=b().getValue(v);if(""===e||null==e)return s.msg.warning("电话不能为空");if(!/^(13[0-9]|14[01456879]|15[0-3,5-9]|16[2567]|17[0-8]|18[0-9]|19[0-3,5-9])\d{8}$/.test(e))return s.msg.warning("手机号码不合法");if(!D)return s.msg.error("请传递验证接口");_(!0),u.post(null,D,{param:l(t({},v,e),N),token:!1,onAny:function(){b().setValue(t({},a,""))},onError:function(){_(!1)}}).then((function(e){var t=setInterval((function(){q("后重新获取"),V((function(e){return--e<=0&&(clearInterval(t),e=O,q("重新获取验证码"),_(!1)),e}))}),1e3)}))}},disabled:x||h,size:p,ghost:!0},C),x&&!h?r.createElement(r.Fragment,null,r.createElement("b",{className:"f14",style:{color:"red"}},L,r.createElement("i",{style:{marginLeft:2}},"s")),r.createElement("span",{style:{marginLeft:2}},"后重新获取验证码")):T))};export{f as default};
