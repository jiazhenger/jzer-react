"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkjzer_react_template"] = self["webpackChunkjzer_react_template"] || []).push([["src__pub_private_component_form_submit-form_jsx"],{

/***/ "./src/_pub/private/component/form/submit-form.jsx":
/*!*********************************************************!*\
  !*** ./src/_pub/private/component/form/submit-form.jsx ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/extends */ \"./node_modules/@babel/runtime/helpers/esm/extends.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var _cpt_utils_submit__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! #cpt/utils/submit */ \"./src/_pub/private/component/utils/submit.js\");\n/* harmony import */ var _item_item_list__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./item/item-list */ \"./src/_pub/private/component/form/item/item-list.jsx\");\n\n\n/* -------------------------------------------------------- Sync Function -- */\n\n/* -------------------------------------------------------- Sync Component -- */\n\n/* -------------------------------------------------------- Declare -- */\nconst {\n  $lazy,\n  $,\n  $fn,\n  $http,\n  $config\n} = window;\n/* -------------------------------------------------------- Async Component -- */\nconst Form = $lazy.hook(() => Promise.all(/*! import() */[__webpack_require__.e(\"vendors-node_modules_react-dom_index_js\"), __webpack_require__.e(\"vendors-node_modules_ant-design_icons_es_components_AntdIcon_js\"), __webpack_require__.e(\"vendors-node_modules_antd_es__util_warning_js-node_modules_antd_es_config-provider_DisabledCo-bef5e4\"), __webpack_require__.e(\"vendors-node_modules_antd_es_config-provider_context_js-node_modules_rc-motion_es_index_js\"), __webpack_require__.e(\"vendors-node_modules_rc-field-form_es_index_js-node_modules_rc-field-form_es_useWatch_js\"), __webpack_require__.e(\"vendors-node_modules_ant-design_icons_es_icons_LoadingOutlined_js-node_modules_antd_es__util_-d6e2e1\"), __webpack_require__.e(\"vendors-node_modules_rc-trigger_es_index_js\"), __webpack_require__.e(\"vendors-node_modules_antd_es_tooltip_index_js\"), __webpack_require__.e(\"vendors-node_modules_antd_es_form_index_js-node_modules_react-is_index_js-node_modules_babel_-fe546a\"), __webpack_require__.e(\"src__pub_global_plugin_antd_form_layout_form_jsx-node_modules_babel_runtime_helpers_esm_objec-31433a\")]).then(__webpack_require__.bind(__webpack_require__, /*! @antd/form/layout/form */ \"./src/_pub/global/plugin/antd/form/layout/form.jsx\")));\nconst FormItem = $lazy.load(() => Promise.all(/*! import() */[__webpack_require__.e(\"vendors-node_modules_react-dom_index_js\"), __webpack_require__.e(\"vendors-node_modules_ant-design_icons_es_components_AntdIcon_js\"), __webpack_require__.e(\"vendors-node_modules_antd_es__util_warning_js-node_modules_antd_es_config-provider_DisabledCo-bef5e4\"), __webpack_require__.e(\"vendors-node_modules_antd_es_config-provider_context_js-node_modules_rc-motion_es_index_js\"), __webpack_require__.e(\"vendors-node_modules_rc-field-form_es_index_js-node_modules_rc-field-form_es_useWatch_js\"), __webpack_require__.e(\"vendors-node_modules_ant-design_icons_es_icons_LoadingOutlined_js-node_modules_antd_es__util_-d6e2e1\"), __webpack_require__.e(\"vendors-node_modules_rc-trigger_es_index_js\"), __webpack_require__.e(\"vendors-node_modules_antd_es_tooltip_index_js\"), __webpack_require__.e(\"vendors-node_modules_antd_es_form_index_js-node_modules_react-is_index_js-node_modules_babel_-fe546a\"), __webpack_require__.e(\"src__pub_global_plugin_antd_form_layout_item_jsx-node_modules_babel_runtime_helpers_esm_objec-dffd93\")]).then(__webpack_require__.bind(__webpack_require__, /*! @antd/form/layout/item */ \"./src/_pub/global/plugin/antd/form/layout/item.jsx\")));\n//\nconst Scrolll = $lazy.load(() => __webpack_require__.e(/*! import() */ \"src__pub_global_template_scroll_jsx\").then(__webpack_require__.bind(__webpack_require__, /*! @tp/scroll */ \"./src/_pub/global/template/scroll.jsx\")));\nconst Controls = $lazy.load(() => Promise.all(/*! import() */[__webpack_require__.e(\"vendors-node_modules_prop-types_index_js\"), __webpack_require__.e(\"vendors-node_modules_react-router_esm_react-router_js\"), __webpack_require__.e(\"src__pub_private_component_temp_Controls_jsx\"), __webpack_require__.e(\"node_modules_react-is_index_js-node_modules_babel_runtime_helpers_esm_objectWithoutProperties-7304800\")]).then(__webpack_require__.bind(__webpack_require__, /*! #cpt/temp/Controls */ \"./src/_pub/private/component/temp/Controls.jsx\")));\nconst Loading = $lazy.load(() => Promise.all(/*! import() */[__webpack_require__.e(\"vendors-node_modules_antd_es_spin_index_js\"), __webpack_require__.e(\"node_modules_antd_es__util_reactNode_js-node_modules_antd_es__util_type_js-node_modules_antd_-781c07\")]).then(__webpack_require__.bind(__webpack_require__, /*! @antd/loading */ \"./src/_pub/global/plugin/antd/loading.jsx\")));\n/* -------------------------------------------------------- 按钮组配置 -- */\nconst Index = (props, ref) => {\n  var _controls5, _controls6, _controls7, _controls8, _controls9;\n  let {\n    className,\n    /** @param {String}\t\t\t\t# 盒子 className */\n    style,\n    /** @param {Object}\t\t\t\t# 盒子 style */\n    data,\n    /** @param {String}\t\t\t\t# 列表数据 */\n    onInit,\n    /** @param {Event}\t\t\t\t# 初始化函数 */\n    onChange,\n    /** @param {Event}\t\t\t\t# 表单改变时执行 */\n    onChanged,\n    /** @param {Event}\t\t\t\t# 元素改变时执行 */\n    onSubmit,\n    /** @param {Event}\t\t\t\t# 提交表单时执行 */\n    loading,\n    /** @param {Boolean}\t\t\t# 加载 */\n    disabled,\n    /** @param {Boolean}\t\t\t# 禁用 */\n    readOnly,\n    /** @param {Boolean}\t\t\t# 只读 */\n    size = 'submit',\n    /** @param {String}\t\t\t\t# 元素大小 */\n    dir = 'x',\n    /** @param {String}\t\t\t\t# 表单排列方向 */\n    x,\n    /** @param {String}\t\t\t\t# 表单排列方向 */\n    colon = true,\n    /** @param {Boolean}\t\t\t# 是否有冒号 */\n    loadingSize,\n    /** @param {Boolean}\t\t \t# 加载大小 */\n    width,\n    /** @param {Number}\t\t\t\t# 全部默认宽度 */\n    controls = {},\n    /** @param {Object}\t\t\t\t# 操作按钮配置 */\n    form,\n    /** @param {Object}\t\t\t\t# 存储值 */\n    submit,\n    /** @param {Object}\t\t\t\t# 额外值 */\n    hideErrorText,\n    /** @param {Boolean}\t\t\t# 是否隐藏提示文字 */\n    nowrap,\n    /** @param {Boolean}\t\t\t# 是否换行排列 */\n    /* --------------------------- SubmitForm 配置 --------------------------- */\n    labelWidth = 's4',\n    /** @param {String}\t\t\t\t# 标签宽度 */\n    mb = 20,\n    /** @param {Number}\t\t\t\t# 间距 */\n    loadingMode = 0,\n    /** @param {Boolean}\t\t\t# 加载模式 */\n    paddingClass = 'p10',\n    /** @param {String}\t\t\t\t# 除按钮之外的表单内容补白 */\n    padding = 8,\n    /** @param {String}\t\t\t\t# 整个盒子补白 */\n    // submit\n    scroll = true,\n    /** @param {Boolean}\t\t\t# 是否滚动 */\n    scrollConfig,\n    /** @param {Object}\t\t\t\t# 滚动配置 */\n    // 插入组件\n    prefix,\n    /** @param {Component}\t\t\t# 前插入组件 */\n    suffix,\n    /** @param {Component}\t\t\t# 后插入组件 */\n    //\n    isSubmitForm = true,\n    /** @param {Boolean}\t\t\t# 是否仅为 SubmitForm */\n    hasMaskLoading,\n    /** @param {Boolean}\t\t\t# 是否有遮罩加载效果 */\n    // http\n    // http={},\t\t\t\t/** @param {Object}\t\t\t\t# 数据请求配置 */\n    api,\n    /** @param {String}\t\t\t\t# api */\n    param,\n    /** @param {Object}\t\t\t\t# 默认提交参数 */\n    cache = $config.cache,\n    /** @param {Boolan}\t\t\t\t# 是否缓存 */\n    mod,\n    /** @param {Boolan}\t\t\t\t# 是否编辑 */\n    add,\n    /** @param {Boolan}\t\t\t\t# 是否新增 */\n    listData,\n    /** @param {Object}\t\t\t\t# 回显数据 */\n    mode,\n    /** @param {Object}\t\t\t\t# 模式 */\n    way /** @param {Object}\t\t\t\t# 提交方式 */\n  } = props;\n  const [list, setList] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(listData);\n  const submitRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)();\n  // 设置底部按钮\n  if ($fn.isObject(controls)) {\n    var _controls, _controls2;\n    controls.align = ((_controls = controls) === null || _controls === void 0 ? void 0 : _controls.align) ?? 'center';\n    controls.size = ((_controls2 = controls) === null || _controls2 === void 0 ? void 0 : _controls2.size) ?? 'middle';\n  }\n  const setControls = formRef => {\n    controls = $fn.getResult(controls, {\n      formRef\n    });\n    if ($fn.isObject(controls) && !controls.data) {\n      const {\n        ok,\n        back,\n        reset,\n        before = [],\n        after = [],\n        antd\n      } = controls;\n      return [...before, $fn.isObject(back) ? {\n        label: '返回',\n        type: 'default',\n        mode: 'back',\n        click: () => {\n          var _controls3, _controls3$onBack;\n          const bool = (_controls3 = controls) === null || _controls3 === void 0 ? void 0 : (_controls3$onBack = _controls3.onBack) === null || _controls3$onBack === void 0 ? void 0 : _controls3$onBack.call(_controls3, formRef);\n          if (bool !== false) {\n            $fn.back();\n          }\n        },\n        ...back\n      } : null, $fn.isObject(reset) ? {\n        label: '重置',\n        ghost: true,\n        mode: 'reset',\n        click: () => {\n          var _controls4, _controls4$onReset;\n          formRef.reset();\n          (_controls4 = controls) === null || _controls4 === void 0 ? void 0 : (_controls4$onReset = _controls4.onReset) === null || _controls4$onReset === void 0 ? void 0 : _controls4$onReset.call(_controls4, formRef);\n        },\n        ...reset\n      } : null, ok !== false && ok !== 0 ? {\n        label: '提交',\n        antd: {\n          htmlType: 'submit',\n          ...antd\n        },\n        ...ok\n      } : null, ...after];\n    } else {\n      return controls.data;\n    }\n  };\n  //\n  const [ajax, setAjax] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({\n    loading\n  });\n  const [result, setResult] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)($fn.getResult(data, {\n    mod,\n    add\n  }));\n  const [btnData, setBtnData] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n  // 加载效果\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (loading !== undefined && !api) {\n      setAjax(() => ({\n        loading\n      }));\n    }\n  }, [loading, api]);\n  // 监听 data 变化\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => setResult($fn.getResult(data, {\n    mod,\n    add\n  })), [data, mod, add]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => setList(listData), [listData]);\n  // 表单提交回显赋值\n  const setBackInfo = formRef => {\n    let {\n      onBackData,\n      backData,\n      infoApi,\n      api,\n      id,\n      idStr = $config.postIdName,\n      backParam,\n      abs,\n      onAdd,\n      onEnd,\n      mode\n    } = props;\n    backParam = $fn.getResult(backParam); // 回显参数\n\n    infoApi = infoApi || api;\n    if (mode === 'add') {\n      return onAdd === null || onAdd === void 0 ? void 0 : onAdd();\n    }\n    if (id || mode === 'mod' || mode === 'info') {\n      id = $fn.getResult(id);\n      if (!abs) {\n        backParam = id ? {\n          [idStr]: id,\n          ...backParam\n        } : backParam;\n      }\n      id = backParam ? null : id;\n      if (props.infoApi !== false || props.infoApi !== 0) {\n        $http.pull(setAjax, infoApi, {\n          id,\n          param: backParam\n        }).then(data => {\n          const p = {\n            data,\n            formRef\n          };\n          if (mode === 'list') {\n            setList(data);\n          } else {\n            if (onBackData) {\n              onBackData === null || onBackData === void 0 ? void 0 : onBackData(p);\n            } else {\n              var _formRef$setValue;\n              backData = $fn.getResult(backData, p);\n              formRef === null || formRef === void 0 ? void 0 : (_formRef$setValue = formRef.setValue) === null || _formRef$setValue === void 0 ? void 0 : _formRef$setValue.call(formRef, {\n                ...data,\n                ...backData\n              });\n            }\n          }\n          onEnd === null || onEnd === void 0 ? void 0 : onEnd(p);\n        });\n      } else {\n        var _formRef$setValue2;\n        const sendParam = {\n          config: props,\n          formRef\n        };\n        // 本地数据回显\n        backData ? formRef === null || formRef === void 0 ? void 0 : (_formRef$setValue2 = formRef.setValue) === null || _formRef$setValue2 === void 0 ? void 0 : _formRef$setValue2.call(formRef, $fn.getResult(backData, sendParam)) : onBackData === null || onBackData === void 0 ? void 0 : onBackData(sendParam);\n        onEnd === null || onEnd === void 0 ? void 0 : onEnd(sendParam);\n      }\n    }\n  };\n  // 更新 data 数据\n  const update = data => {\n    if ($fn.hasArray(data)) {\n      setResult([...data]);\n    } else {\n      setResult(d => [...d]);\n    }\n  };\n  const expose = {\n    ...$.ref(submitRef),\n    update\n  };\n  //\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useImperativeHandle)(ref, () => ({\n    ref: () => expose,\n    SubmitUtils: _cpt_utils_submit__WEBPACK_IMPORTED_MODULE_2__[\"default\"]\n  }));\n  let controlsMt = scroll ? 0 : 10;\n  let paddingStyle = null;\n  if (x) {\n    scroll = false;\n    labelWidth = null;\n    if ($fn.isObject(controls)) {\n      controls.size = size;\n    }\n    controlsMt = 0;\n    paddingStyle = {\n      padding\n    };\n  }\n\n  // FormItem\n  const itemList = {\n    size,\n    colon,\n    width,\n    mb,\n    readOnly,\n    onChanged,\n    x,\n    cache,\n    form,\n    submit,\n    nowrap,\n    ctrlMode: mode,\n    data: result,\n    listData: list,\n    paddingClass: x ? '' : $.css(!scroll, paddingClass),\n    className: $.css(x, 'ex'),\n    disabled: disabled || (loadingMode === 0 ? ajax.loading : false),\n    formRef: () => $.ref(submitRef),\n    expose\n  };\n  const ContentComponent = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_item_item_list__WEBPACK_IMPORTED_MODULE_3__[\"default\"], itemList);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Form, {\n    ref: submitRef,\n    className: `rel jzer-form jzer-form-${size} ${$.css(scroll, 'fv ex')} ${$.css(x, 'fx')} ${labelWidth} ${$.css(className)}`,\n    style: {\n      ...paddingStyle,\n      ...style\n    },\n    dir: dir,\n    onChange: onChange,\n    onNameChange: value => {},\n    data: result,\n    param: param,\n    hideErrorText: hideErrorText,\n    onRef: formRef => {\n      // 配置默认参数\n      param = $fn.getResult(param);\n      formRef.setDefaultValue(result, param);\n      if (isSubmitForm) {\n        setBackInfo(formRef);\n      }\n      onInit === null || onInit === void 0 ? void 0 : onInit({\n        formRef,\n        param,\n        data\n      });\n      setBtnData(setControls(formRef));\n    },\n    onSubmit: param => {\n      var _submit;\n      const formRef = $.ref(submitRef);\n      const back = (_submit = submit) === null || _submit === void 0 ? void 0 : _submit.back;\n      if (back) {\n        submit = {\n          ...back,\n          ...submit\n        };\n        if ($fn.hasObject(back)) {\n          delete submit.back;\n        }\n      }\n      param = {\n        ...submit,\n        ...param\n      };\n      if (isSubmitForm) {\n        (0,_cpt_utils_submit__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n          onSubmit,\n          param,\n          submitConfig: props,\n          ajax: setAjax,\n          formRef,\n          form,\n          way\n        });\n      } else {\n        onSubmit === null || onSubmit === void 0 ? void 0 : onSubmit({\n          param,\n          formRef,\n          form\n        });\n      }\n    }\n  }, scroll ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"div\", {\n    className: `ex rel`\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Scrolll, (0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n    className: $.css(paddingClass)\n  }, scrollConfig), prefix, ContentComponent, suffix)) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, null, prefix, ContentComponent, suffix), controls !== false && controls !== 0 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(FormItem, (0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n    className: `${$.css(scroll, 'tbor1')}`,\n    label: \"\\xA0\",\n    colon: false,\n    mt: controlsMt\n  }, (_controls5 = controls) === null || _controls5 === void 0 ? void 0 : _controls5.item), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Controls, (0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n    loading: loadingMode === 0 ? ajax.loading : false,\n    className: $.css(!x && scroll, ((_controls6 = controls) === null || _controls6 === void 0 ? void 0 : _controls6.paddingClass) ?? 'p10'),\n    align: (_controls7 = controls) === null || _controls7 === void 0 ? void 0 : _controls7.align,\n    size: (_controls8 = controls) === null || _controls8 === void 0 ? void 0 : _controls8.size,\n    data: btnData\n  }, (_controls9 = controls) === null || _controls9 === void 0 ? void 0 : _controls9.config))), (loadingMode === 1 || hasMaskLoading) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Loading, {\n    loading: ajax.loading,\n    loadingSize: loadingSize\n  }));\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (Index);\n\n//# sourceURL=webpack://jzer-react-template/./src/_pub/private/component/form/submit-form.jsx?");

/***/ }),

/***/ "./src/_pub/private/component/utils/submit.js":
/*!****************************************************!*\
  !*** ./src/_pub/private/component/utils/submit.js ***!
  \****************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* -------------------------------------------------------- Declare -- */\nconst {\n  $fn,\n  $http,\n  $config\n} = window;\n/**\r\n * 提交表单\r\n */\nconst Index = ({\n  ajax,\n  /** @param {Function}\t\t\t# 渲染函数 */\n  param,\n  /** @param {Object}\t\t\t\t# 表单参数 */\n  submitConfig = {},\n  /** @param {Object}\t\t\t\t# 数据请求配置 */\n  form,\n  /** @param {Object}\t\t\t\t# 存储值 */\n  formRef,\n  /** @param {Object}\t\t\t\t# 表单 ref */\n  onSubmit,\n  /** @param {Event}\t\t\t\t# 自定义提交 */\n  // table\n  tableRef,\n  /** @param {String}\t\t\t\t# tableRef */\n  // tableModal\n  modalTableRef,\n  /** @param {Object}\t\t\t\t# 弹窗表格的 tableRef */\n  // modal\n  modalRef,\n  /** @param {Object}\t\t\t\t# 弹窗 ref */\n  title /** @param {String}\t\t\t\t# 弹窗标题 */\n  // form\n}) => {\n  // 配置 Config\n  let {\n    // http\n    api,\n    /** @param {String}\t\t\t\t# api */\n    modApi,\n    /** @param {String}\t\t\t\t# 修改 api */\n    clearApi,\n    /** @param {String}\t\t\t\t# 清除缓存 */\n    way = 'post',\n    /** @param {String}\t\t\t\t# 请求方式 */\n    modWay = ($config === null || $config === void 0 ? void 0 : $config.modWay) ?? 'put',\n    /** @param {String}\t\t\t\t# 编辑时的请求方式 */\n    loading = false,\n    /** @param {Boolean}\t\t\t# 是否默认显示加载效果 */\n    loadingText,\n    /** @param {String}\t\t\t\t# 加载提示 */\n    back,\n    /** @param {Boolean}\t\t\t# 是否返回 */\n    backRefresh,\n    /** @param {Boolean}\t\t\t# 返回并刷新 */\n    must,\n    /** @param {Boolean}\t\t\t# 可选参数 + 必选参数 */\n    empty,\n    /** @param {Object}\t\t\t\t# 空参数配置 */\n    // param, \t\t\t\t\t\t/** @param {String}\t\t\t\t# 提交的额外参数 */\n    // table\n    refApi,\n    /** @param {String}\t\t\t\t# table api */\n    id,\n    /** @param {String}\t\t\t\t# id 值 */\n    idStr = $config.postIdName,\n    /** @param {String}\t\t\t\t# id 字段 */\n    // 弹窗\n    mode,\n    /** @param {String}\t\t\t\t# 编辑与添加类型 */\n    add,\n    /** @param {String}\t\t\t\t# 是否是添加 */\n    mod,\n    /** @param {String}\t\t\t\t# 是否是编辑 */\n    successText,\n    /** @param {String}\t\t\t\t# 成功提示 */\n    close,\n    /** @param {Boolean}\t\t\t# 是否关闭弹窗 */\n    r,\n    /** @param {Boolean}\t\t\t# 是否刷新 */\n    c,\n    /** @param {Boolean}\t\t\t# 是否清除 keys */\n    rs,\n    /** @param {Boolean}\t\t\t# 刷新后滚动是否回到顶部*/\n    rc,\n    /** @param {Boolean}\t\t\t# 是否刷新并清除 keys */\n    // 参数处理\n    setNewParam,\n    /** @param {Event}\t\t\t\t# 处理参数，反回新的参数 { ...param, a:1 } */\n    setParam,\n    /** @param {Event}\t\t\t\t# 处理参数，仅返回处理后的参数 { a: 1} */\n    onValid,\n    /** @param {Event}\t\t\t\t# 验证表单 */\n    // 自定义\n    // onSubmit, \t\t\t\t\t\t/** @param {Event}\t\t\t\t# 自定义提交 */\n    // ajax 请求后执行\n    onComplete,\n    /** @param {Event}\t\t\t\t# 完后执行 */\n    onSuccess,\n    /** @param {Event}\t\t\t\t# 请求成功后执行 */\n    onFail,\n    /** @param {Event}\t\t\t\t# 请求失败执行 */\n    onError /** @param {Event}\t\t\t\t# 请求错误执行 */\n  } = submitConfig;\n  // 参数处理\n  param = {\n    ...$fn.getResult(submitConfig.param),\n    ...$fn.getResult(param)\n  };\n  param = setParam ? {\n    ...param,\n    ...setParam(param)\n  } : param; // 处理参数\n  if (setNewParam) {\n    param = setNewParam(param);\n  } // 重新组合参数\n  if (onValid && onValid(param)) {\n    return;\n  } // 参数验证\n  // 规范提交\n  onSubmit = onSubmit ?? (submitConfig === null || submitConfig === void 0 ? void 0 : submitConfig.onSubmit);\n  tableRef = $fn.getResult(tableRef);\n  if (api && !onSubmit) {\n    // 编辑时\n    if (mode === 'mod') {\n      way = modWay;\n      empty = empty === undefined ? true : empty;\n      api = modApi ?? api;\n      if (!must) {\n        param = {\n          [idStr]: id,\n          ...param\n        };\n      }\n      if ($fn.hasObject(ajax.ids) && !must) {\n        param = {\n          ...ajax.ids,\n          ...param\n        };\n      }\n    } else if (mode === 'add') {\n      empty = false;\n    }\n    rc = $fn.getResult(rc);\n    r = $fn.getResult(r);\n    c = $fn.getResult(c);\n\n    // 清楚缓存\n    if (clearApi) {\n      clearApi = $fn.isString(clearApi) ? clearApi : refApi;\n    }\n    // title\n    title = title ? title : submitConfig.title;\n    // $http\n    $http[way](ajax, api, {\n      param,\n      id: must ? id : null,\n      loadingText,\n      loading,\n      empty,\n      onEnd: () => onComplete === null || onComplete === void 0 ? void 0 : onComplete({\n        formRef,\n        colse: modalRef === null || modalRef === void 0 ? void 0 : modalRef.close\n      }),\n      onFail: data => onFail === null || onFail === void 0 ? void 0 : onFail({\n        formRef,\n        colse: modalRef === null || modalRef === void 0 ? void 0 : modalRef.close,\n        data\n      }),\n      onError: () => onError === null || onError === void 0 ? void 0 : onError({\n        formRef,\n        colse: modalRef === null || modalRef === void 0 ? void 0 : modalRef.close\n      })\n    }).then(data => {\n      if (tableRef) {\n        if (r) {\n          tableRef.refresh(rs);\n        }\n        if (c) {\n          tableRef.clearKeys();\n        }\n        if (rc && !r && !c) {\n          tableRef.refreshClear(rs);\n        }\n      }\n      if (modalTableRef) {\n        modalTableRef.clearKeys();\n      }\n      let msg = (title ?? '操作') + '成功';\n      if (successText) {\n        msg = successText;\n      } // 自定义成功提示\n      $fn.msg.success(msg);\n      const p = {\n        data,\n        param,\n        formRef,\n        tableRef,\n        modalTableRef,\n        colse: modalRef === null || modalRef === void 0 ? void 0 : modalRef.close\n      };\n      onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(p);\n\n      // 清除缓存\n      if (clearApi) {\n        $fn.indexDBRemove(clearApi);\n      }\n      // 成功后是否返回\n      if (back) {\n        window.history.back();\n      }\n      if (backRefresh) {\n        window.history.back();\n        if (backRefresh === true || backRefresh === 1) {\n          backRefresh = 'refresh';\n        }\n        setTimeout(() => {\n          var _window$backRefresh, _window;\n          return (_window$backRefresh = (_window = window)[backRefresh]) === null || _window$backRefresh === void 0 ? void 0 : _window$backRefresh.call(_window);\n        }, 100);\n      }\n      // 成功后是否关闭弹窗\n      close = $fn.getResult(close, {\n        mod,\n        add\n      });\n      if (close !== false && modalRef) {\n        modalRef === null || modalRef === void 0 ? void 0 : modalRef.close();\n      }\n    });\n  } else {\n    var _formRef$getValue, _onSubmit;\n    // 自定义提交\n    const formParam = formRef ? {\n      formParam: formRef === null || formRef === void 0 ? void 0 : (_formRef$getValue = formRef.getValue) === null || _formRef$getValue === void 0 ? void 0 : _formRef$getValue.call(formRef),\n      formRef\n    } : null;\n    const close = (_onSubmit = onSubmit) === null || _onSubmit === void 0 ? void 0 : _onSubmit({\n      param,\n      modalRef,\n      ...formParam,\n      tableRef,\n      modalTableRef,\n      close: modalRef === null || modalRef === void 0 ? void 0 : modalRef.close,\n      form\n    });\n    // 成功后是否关闭弹窗\n    if (close !== false) {\n      modalRef === null || modalRef === void 0 ? void 0 : modalRef.close();\n    }\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (Index);\n\n//# sourceURL=webpack://jzer-react-template/./src/_pub/private/component/utils/submit.js?");

/***/ })

}]);